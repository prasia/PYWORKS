<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="./css/user-profile.css">
    <link rel="icon" href="./images/heroimg.png">
    <title>User Profile</title>
</head>
<body>
    <header>
        <!--Nav-->
        <div class = "nav container">
        <!--Logo-->
        <a href = "./index.html" class = "logo">PY<span>WORKS.</span></a>
        <!--Login/ View Profile-->
        <a href= "./login.html" class = "login">Login</a>
        </div>
    </header>

    <div class="profile-container">
        <img src="./images/silverage.png" alt="User Profile Picture" class = "pfp-image">
        <h3 class="display-name">Loading...</h3>
        <h5 class="display-email">Loading...</h3>
    </div>

    <script type="module">
        // Import the functions you need from the SDKs you need
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.5.0/firebase-app.js";

        import { getAuth, GoogleAuthProvider, signInWithPopup, signOut, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/10.5.0/firebase-auth.js";
        // import { getAnalytics } from "https://www.gstatic.com/firebasejs/10.5.0/firebase-analytics.js";
        // TODO: Add SDKs for Firebase products that you want to use
        // https://firebase.google.com/docs/web/setup#available-libraries
      
        // Your web app's Firebase configuration
        // For Firebase JS SDK v7.20.0 and later, measurementId is optional
        const firebaseConfig = {
          apiKey: "AIzaSyAacuiuUfx9xPozqMnx2gjVhvlLrKDW8U8",
          authDomain: "pyz-test.firebaseapp.com",
          databaseURL: "https://pyz-test-default-rtdb.firebaseio.com",
          projectId: "pyz-test",
          storageBucket: "pyz-test.appspot.com",
          messagingSenderId: "1002244320159",
          appId: "1:1002244320159:web:e30ed55eb549fef3fc2baa",
          measurementId: "G-RDP6P39C09"
        };
      
        // Initialize Firebase
        const app = initializeApp(firebaseConfig);
        const auth = getAuth();
        const provider = new GoogleAuthProvider();

        const pfpImg = document.querySelector('.pfp-image');
        const displayName = document.querySelector('.display-name');
        const emailShow = document.querySelector('.display-email');
        const loginButton = document.querySelector('.login');

        onAuthStateChanged(auth, (user) => {
            if (user){ //Only if the user is signed in 
                displayName.innerHTML = user.displayName;
                pfpImg.src = user.photoURL;
                emailShow.innerHTML = user.email;
                loginButton.innerHTML = 'Logout';
                loginButton.href = './login.html';
                // userEmail.innerHTML = user.email;
                

                // var url = window.location.href;
                // console.log(url)
                // // url = "/login.html?loggedIn=true";
                // window.location.replace(url);

            } else{ //If user is not signed in
                signOutButton.style.display = "none";
                message.style.display = "none";
            }
        })

        // signOutButton.style.display = "none";
        // message.style.display = "none";


        // const analytics = getAnalytics(app);

    </script>


    
</body>
</html>